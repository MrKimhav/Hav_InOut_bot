<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ášá”á¶á™á€á¶ášááŸá›á€áŸ‹</title>
    <style>
        body { font-family: 'Hanuman', sans-serif; padding: 15px; background-color: #f8f9fa; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        table { width: 100%; border-collapse: collapse; background: white; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #007bff; color: white; position: sticky; top: 0; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .summary { margin-top: 15px; padding: 15px; background: #e9ecef; border-radius: 8px; font-weight: bold; font-size: 18px; color: #28a745; text-align: right; }
        .btn-back { padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 4px; text-decoration: none; font-size: 14px; }
    </style>
</head>
<body>

<div class="header">
    <h3>ğŸ“Š ášá”á¶á™á€á¶ášááŸá›á€áŸ‹</h3>
    <a href="index.html" class="btn-back">â¬…ï¸ ááŸ’ášá¡á”áŸ‹á€áŸ’ášáŸ„á™</a>
</div>

<table id="reportTable">
    <thead>
        <tr>
            <th>á€á¶á›á”ášá·á…áŸ’á†áŸá‘</th>
            <th>á‚áŸ„á›áŠáŸ…</th>
            <th>á…áŸá‰</th>
            <th>á…á¼á›</th>
            <th>á›á€áŸ‹á”á¶á“</th>
        </tr>
    </thead>
    <tbody id="tableBody">
        </tbody>
</table>

<div class="summary" id="totalDisplay">
    áŸášá»á”á€á¶ášá›á€áŸ‹áŸ– 0
</div>

<script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbw1CZL_rPXcYLkKe7zNpNk2kXSODuoG22FdCEU0POPx_yZicdoHoOLS478hutjxhrY/exec"; 

    fetch(scriptURL)
    .then(res => res.json())
    .then(data => {
        const tableBody = document.getElementById("tableBody");
        let totalSold = 0;

        // á”áŸ’ášá¾ .slice(2) áŠá¾á˜áŸ’á”á¸á…á¶á”áŸ‹á™á€á…á¶á”áŸ‹á–á¸á‡á½ášá‘á¸ áŸ£ á‘áŸ… (á‡á½ášá‘á¸áŸ¡ á‚áº index 0, á‡á½ášá‘á¸áŸ¢ á‚áº index 1)
        const filteredData = data.slice(2); 

        // á”á‰áŸ’á…áŸ’ášá¶áŸá‘á·á“áŸ’á“á“áŸá™áŠáŸ‚á›á”á¶á“á€á¶ááŸ‹ášá½á… áŠá¾á˜áŸ’á”á¸á±áŸ’á™á¢á¶ááŸ’á˜á¸á“áŸ…áá¶á„á›á¾
        filteredData.reverse().forEach(row => {
            const tr = document.createElement("tr");
            
            // á€á¼áŠáŸá˜áŸ’ášá¶á”áŸ‹ášáŸ€á”á…áŸ†ááŸ’á„áŸƒááŸ‚ (áŠá¼á…áŠáŸ‚á›á™á¾á„á”á¶á“á’áŸ’áœá¾á–á¸á˜á»á“)
            let displayDate = "á˜á·á“áŸáŸ’á‚á¶á›áŸ‹ááŸ’á„áŸƒ";
            if (row[0]) {
                const d = new Date(row[0]);
                if (!isNaN(d)) {
                    displayDate = d.toLocaleDateString('km-KH') + " " + d.toLocaleTimeString('km-KH', {hour: '2-digit', minute:'2-digit'});
                }
            }

            tr.innerHTML = `
                <td>${displayDate}</td>
                <td>${row[1] || 0}</td>
                <td>${row[2] || 0}</td>
                <td>${row[3] || 0}</td>
                <td>${row[4] || 0}</td>
            `;
            tableBody.appendChild(tr);
            
            totalSold += parseFloat(row[4]) || 0;
        });

        document.getElementById("totalDisplay").innerText = "áŸášá»á”áŸ– " + totalSold.toLocaleString();
    })
    .catch(error => console.error('Error:', error));
</script>

</body>
</html>






